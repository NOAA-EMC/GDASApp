input geometry:
  geom_grid_file: soca_gridspec.nc
  mom6_input_nml: mom_input.nml
  fields metadata: fields_metadata.yaml

output geometry:
  geom_grid_file: soca_gridspec.nc
  mom6_input_nml: mom_input.nml
  fields metadata: fields_metadata.yaml

linear variable change:
  input variables: [tocn, socn, ssh, uocn, vocn, hocn, cicen, hicen, hsnon]
  output variables: [tocn, socn, ssh, uocn, vocn, hocn, cicen, hicen, hsnon]
  do inverse: false
  linear variable changes:
  - linear variable change name: BkgErrFILT
    ocean_depth_min: 500  # zero where ocean is shallower than 500m
    rescale_bkgerr: 0.3   # rescale perturbation
    efold_z: 1500.0       # Apply exponential decay
  - linear variable change name: BalanceSOCA  # linear steric height from (T,S) perturbation

increments:
- date: '{{ATM_WINDOW_BEGIN}}'
  input variables: [tocn, socn, ssh, uocn, vocn, hocn, cicen, hicen, hsnon]
  input:
     read_from_file: 1
     basename: ./static_ens/
     ocn_filename: 'ocn.bal.ens.MEMNUM.{{ATM_WINDOW_BEGIN}}.PT0S.nc'
     ice_filename: 'ice.bal.ens.MEMNUM.{{ATM_WINDOW_BEGIN}}.PT0S.nc'
     date: '{{ATM_WINDOW_BEGIN}}'
     state variables: [ssh, tocn, socn, uocn, vocn, cicen, hicen, hsnon]
  trajectory:
    read_from_file: 1
    basename: ./INPUT/
    ocn_filename: MOM.res.nc
    ice_filename: cice.res.nc
    date: '{{ATM_WINDOW_BEGIN}}'
    state variables: [cicen, hicen, hsnon, socn, tocn, uocn, vocn, ssh, hocn, mld, layer_depth]
  output:
     datadir: ./static_ens
     exp: filtered.MEMNUM
     type: incr
     date: '{{ATM_WINDOW_BEGIN}}'
