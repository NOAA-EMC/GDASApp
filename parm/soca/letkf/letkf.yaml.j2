# copied from sorc/soca/test/testinput/letkf.yml
geometry:
  #geom_grid_file: data_generated/gridgen/soca_gridspec.72x35x25.nc
  #mom6_input_nml: data_static/72x35x25/input.nml
  #fields metadata: data_static/fields_metadata.yml
  geom_grid_file: soca_gridspec.nc
  mom6_input_nml: mom_input.nml
  fields metadata: fields_metadata.yaml

time window:
 # begin: &date 2018-04-14T00:00:00Z
  #length: P2D
  begin: &date '{{ ATM_WINDOW_BEGIN }}'
  length: PT6H 

background:
  members from template:
#    template:
#      date: 2018-04-15T00:00:00Z
#      ocn_filename: MOM.res.ens.%mem%.nc
#      read_from_file: 1
#      basename: data_static/72x35x25/restarts_ens/
#      state variables: [socn, tocn, ssh, uocn, vocn, hocn, chl, biop]
#    pattern: '%mem%'
#    nmembers: 4
    template:
      #date: 2018-04-15T00:00:00Z
      date: '{{ ATM_WINDOW_MIDDLE }}'
      ocn_filename: enkfgdas.ocean.t06z.inst.f009.nc
      ice_filename: enkfgdas.ice.t06z.inst.f009.nc
      read_from_file: 1
      basename: ./ens/mem%mem%
      state variables: [socn, tocn, ssh, uocn, vocn, cicen]
    pattern: '%mem%'
    nmembers: {{ NMEM_ENS  }}

observations:
  observers:
# insert obs spaces here

driver:
  do posterior observer: true
  save posterior mean increment: true
  save posterior mean: true
  save posterior variance: true
  save prior mean: true
  save prior variance: true

local ensemble DA:
  solver: LETKF
  inflation:
    rtps: 0.5
    rtpp: 0.6
    mult: 1.1

output:
  datadir: data_output/
  date: *date
  exp: letkf
  type: ens

output mean prior:
  datadir: data_output/
  date: *date
  exp: letkf
  type: fc

output variance prior:
  datadir: data_output/
  date: *date
  exp: letkf
  type: fc

output variance posterior:
  datadir: data_output/
  date: *date
  exp: letkf
  type: an

output increment:
  datadir: data_output/
  date: *date
  exp: letkf.inc
  type: an

