obs space:
  name: iasi_metop-a
  obsdatain:
    engine:
      type: H5File
      obsfile: $(DATA)/obs/$(OPREFIX)mtiasi_metop-a.tm00.nc
  obsdataout:
    engine:
      type: H5File
      obsfile: $(DATA)/diags/diag_iasi_metop-a_{{ current_cycle | to_YMDH }}.nc
  io pool:
    max pool size: 1
  observed variables: [radiance]
  simulated variables: [brightnessTemperature]
  derived variables: [brightnessTemperature]
  channels: &iasi_metop-a_channels 16, 29, 32, 35, 38, 41, 44, 47, 49, 50, 51, 53,
            55, 56, 57, 59, 61, 62, 63, 66, 68, 70, 72, 74, 76, 78, 79, 81, 82, 83,
            84, 85, 86, 87, 89, 92, 93, 95, 97, 99, 101, 103, 104, 106, 109, 110,
            111, 113, 116, 119, 122, 125, 128, 131, 133, 135, 138, 141, 144, 146,
            148, 150, 151, 154, 157, 159, 160, 161, 163, 167, 170, 173, 176, 179,
            180, 185, 187, 191, 193, 197, 199, 200, 202, 203, 205, 207, 210, 212,
            213, 214, 217, 218, 219, 222, 224, 225, 226, 228, 230, 231, 232, 236,
            237, 239, 243, 246, 249, 252, 254, 259, 260, 262, 265, 267, 269, 275,
            279, 282, 285, 294, 296, 299, 300, 303, 306, 309, 313, 320, 323, 326,
            327, 329, 332, 335, 345, 347, 350, 354, 356, 360, 363, 366, 371, 372,
            373, 375, 377, 379, 381, 383, 386, 389, 398, 401, 404, 405, 407, 408,
            410, 411, 414, 416, 418, 423, 426, 428, 432, 433, 434, 439, 442, 445,
            450, 457, 459, 472, 477, 483, 509, 515, 546, 552, 559, 566, 571, 573,
            578, 584, 594, 625, 646, 662, 668, 705, 739, 756, 797, 867, 906, 921,
            1027, 1046, 1090, 1098, 1121, 1133, 1173, 1191, 1194, 1222, 1271, 1283,
            1338, 1409, 1414, 1420, 1424, 1427, 1430, 1434, 1440, 1442, 1445, 1450,
            1454, 1460, 1463, 1469, 1474, 1479, 1483, 1487, 1494, 1496, 1502, 1505,
            1509, 1510, 1513, 1518, 1521, 1526, 1529, 1532, 1536, 1537, 1541, 1545,
            1548, 1553, 1560, 1568, 1574, 1579, 1583, 1585, 1587, 1606, 1626, 1639,
            1643, 1652, 1658, 1659, 1666, 1671, 1675, 1681, 1694, 1697, 1710, 1786,
            1791, 1805, 1839, 1884, 1913, 1946, 1947, 1991, 2019, 2094, 2119, 2213,
            2239, 2271, 2289, 2321, 2333, 2346, 2349, 2352, 2359, 2367, 2374, 2398,
            2426, 2562, 2701, 2741, 2745, 2760, 2819, 2889, 2907, 2910, 2919, 2921,
            2939, 2944, 2945, 2948, 2951, 2958, 2971, 2977, 2985, 2988, 2990, 2991,
            2993, 3002, 3008, 3014, 3027, 3029, 3030, 3036, 3047, 3049, 3052, 3053,
            3055, 3058, 3064, 3069, 3087, 3093, 3098, 3105, 3107, 3110, 3116, 3127,
            3129, 3136, 3146, 3151, 3160, 3165, 3168, 3175, 3178, 3189, 3207, 3228,
            3244, 3248, 3252, 3256, 3263, 3281, 3295, 3303, 3309, 3312, 3322, 3326,
            3354, 3366, 3375, 3378, 3411, 3416, 3432, 3438, 3440, 3442, 3444, 3446,
            3448, 3450, 3452, 3454, 3458, 3467, 3476, 3484, 3491, 3497, 3499, 3504,
            3506, 3509, 3518, 3527, 3555, 3575, 3577, 3580, 3582, 3586, 3589, 3599,
            3610, 3626, 3638, 3646, 3653, 3658, 3661, 3673, 3689, 3700, 3710, 3726,
            3763, 3814, 3841, 3888, 4032, 4059, 4068, 4082, 4095, 4160, 4234, 4257,
            4411, 4498, 4520, 4552, 4567, 4608, 4646, 4698, 4808, 4849, 4920, 4939,
            4947, 4967, 4991, 4996, 5015, 5028, 5056, 5128, 5130, 5144, 5170, 5178,
            5183, 5188, 5191, 5368, 5371, 5379, 5381, 5383, 5397, 5399, 5401, 5403,
            5405, 5446, 5455, 5472, 5480, 5483, 5485, 5492, 5497, 5502, 5507, 5509,
            5517, 5528, 5558, 5697, 5714, 5749, 5766, 5785, 5798, 5799, 5801, 5817,
            5833, 5834, 5836, 5849, 5851, 5852, 5865, 5869, 5881, 5884, 5897, 5900,
            5916, 5932, 5948, 5963, 5968, 5978, 5988, 5992, 5994, 5997, 6003, 6008,
            6023, 6026, 6039, 6053, 6056, 6067, 6071, 6082, 6085, 6098, 6112, 6126,
            6135, 6140, 6149, 6154, 6158, 6161, 6168, 6174, 6182, 6187, 6205, 6209,
            6213, 6317, 6339, 6342, 6366, 6381, 6391, 6489, 6962, 6966, 6970, 6975,
            6977, 6982, 6985, 6987, 6989, 6991, 6993, 6995, 6997, 6999, 7000, 7004,
            7008, 7013, 7016, 7021, 7024, 7027, 7029, 7032, 7038, 7043, 7046, 7049,
            7069, 7072, 7076, 7081, 7084, 7089, 7099, 7209, 7222, 7231, 7235, 7247,
            7267, 7269, 7284, 7389, 7419, 7423, 7424, 7426, 7428, 7431, 7436, 7444,
            7475, 7549, 7584, 7665, 7666, 7831, 7836, 7853, 7865, 7885, 7888, 7912,
            7950, 7972, 7980, 7995, 8007, 8015, 8055, 8078

obs operator:
  name: CRTM
  Absorbers: [H2O,O3,CO2]
  obs options:
    Sensor_ID: iasi_metop-a 
    EndianType: little_endian
    CoefficientPath: $(DATA)/crtm/
  linear obs operator:
    Absorbers: [H2O,O3]

obs bias:
  input file: $(DATA)/obs/$(GPREFIX)iasi_metop-a.satbias.nc
  output file: $(DATA)/bc/$(APREFIX)iasi_metop-a.satbias.nc
  variational bc:
    predictors:
    - name: constant
    - name: lapse_rate
      order: 2
      tlapse: &iasi_metop-a_tlapse $(DATA)/obs/$(GPREFIX)iasi_metop-a.tlapse.txt
    - name: lapse_rate
      tlapse: *iasi_metop-a_tlapse
    - name: emissivity
    - name: scan_angle
      order: 4
    - name: scan_angle
      order: 3
    - name: scan_angle
      order: 2
    - name: scan_angle
  covariance:
    minimal required obs number: 20
    variance range: [1.0e-6, 10.0]
    step size: 1.0e-4
    largest analysis variance: 10000.0
    prior:
      input file: $(DATA)/obs/$(GPREFIX)iasi_metop-a.satbias_cov.nc
      inflation:
        ratio: 1.1
        ratio for small dataset: 2.0
    output file: $(DATA)/bc/$(APREFIX)iasi_metop-a.satbias_cov.nc

obs pre filters:
# Step 0-A: Create Diagnostic Flags
#- filter: Create Diagnostic Flags
#  filter variables:
#  - name: brightnessTemperature
#    channels: *iasi_metop-a_channels
#  flags:
#  - name: ScanEdgeRemoval
#    initial value: false
#    force reinitialization: false
#  - name: Thinning
#    initial value: false
#    force reinitialization: false
#  - name: ShortwaveIRCheck
#    initial value: false
#    force reinitialization: false
#  - name: ObsValueRangeCheck
#    initial value: false
#    force reinitialization: false
#  - name: CloudDetection
#    initial value: false
#    force reinitialization: false
#  - name: NSSTCheck
#    initial value: false
#    force reinitialization: false
#  - name: GrossCheck
#    initial value: false
#    force reinitialization: false
#  - name: InterChannelConsistency
#    initial value: false
#    force reinitialization: false
#  - name: UseFlagCheck
#    initial value: false
#    force reinitialization: false

# Step 0-B: Create Derived Variables
# Assign channel wavenumbers in m-1
- filter: Variable Assignment
  assignments:
  - name: MetaData/sensorCentralWavenumber
    type: float
    channels: *iasi_metop-a_channels
    function:
      name: ObsFunction/LinearCombination
      options:
        variables:
        - name: ObsValue/radiance
          channels: *iasi_metop-a_channels
        coefs: [25.0]
        intercept: 64475.0
        use channel numbers: true

# Transform radiance to brightness temperature 
- filter: Variable Transforms
  Transform: SatBrightnessTempFromRad
  transform from:
    name: ObsValue/radiance
    channels: *iasi_metop-a_channels
  spectral variable:
    name: MetaData/sensorCentralWavenumber
    channels: *iasi_metop-a_channels
  radiance units: wavenumber
  planck1: 1.191042953e-16
  planck2: 1.4387774e-2

# Step 0-C: Assign Observation Error
obs prior filters:
- filter: Perform Action
  filter variables:
  - name: brightnessTemperature
    channels:  *iasi_metop-a_channels
  action:
    name: assign error
    error parameter vector: &iasi_metop-a_oberr [ 1.38, 0.81, 0.75, 0.79, 0.72, 0.74, 0.68, 0.72, 0.65, 0.65, 
                            0.65, 0.69, 0.64, 0.64, 0.65, 0.67, 0.62, 0.61, 0.62, 0.64, 0.59, 0.76, 
                            1.22, 0.78, 0.64, 0.62, 0.61, 0.69, 0.65, 0.59, 0.61, 0.59, 0.68, 0.62, 
                            0.68, 4.38, 3.05, 2.31, 1.56, 1.33, 1.58, 0.93, 1.67, 0.72, 0.57, 0.58, 
                            0.55, 0.68, 0.59, 0.68, 0.59, 0.65, 0.58, 0.62, 0.64, 0.58, 0.64, 0.55, 
                            0.64, 0.5, 0.82, 0.59, 0.62, 0.51, 0.64, 0.52, 0.51, 0.51, 0.76, 0.52, 
                            0.57, 0.55, 0.69, 0.58, 0.65, 0.61, 0.59, 0.64, 0.76, 0.72, 1.05, 0.75, 
                            0.51, 0.65, 1.3, 0.69, 0.93, 1.49, 1.12, 0.68, 0.66, 0.67, 0.59, 0.59, 
                            0.69, 0.67, 0.64, 0.62, 0.72, 0.69, 0.66, 0.79, 0.78, 0.74, 0.88, 0.77, 
                            0.88, 0.86, 1, 0.87, 0.85, 0.88, 0.84, 0.84, 0.84, 0.8, 0.8, 0.87, 
                            0.98, 0.52, 0.65, 0.69, 0.61, 0.6, 0.67, 0.79, 0.62, 0.66, 0.7, 0.65, 
                            0.62, 0.61, 0.62, 0.53, 0.6, 0.68, 0.95, 0.63, 0.97, 0.65, 0.98, 0.58, 
                            0.73, 0.65, 0.85, 0.99, 0.76, 0.85, 0.97, 0.77, 0.62, 0.63, 1.21, 1.41, 
                            1.55, 1.78, 1.35, 1.14, 1.69, 1.79, 1.46, 1.63, 1.94, 2.01, 1.24, 1.76, 
                            1.26, 1.47, 1.9, 1.66, 2.13, 1.49, 1.52, 1.55, 1.96, 2.31, 2.33, 2.32, 
                            2.31, 2.33, 2.23, 2.33, 1.84, 2.29, 2.28, 2.28, 2.28, 2.26, 2.26, 2.26, 
                            2.27, 2.24, 2.23, 2.24, 2.26, 2.28, 2.28, 2.3, 2.15, 2.31, 2.37, 2.27, 
                            2.29, 2.29, 2.23, 2.28, 2.32, 2.32, 2.31, 2.32, 2.32, 2.31, 2.31, 2.28, 
                            2.29, 2.28, 2.26, 2.29, 2.27, 2.26, 2.25, 2.27, 2.24, 2.21, 2.24, 2.17, 
                            2.18, 2.17, 2.21, 1.99, 2.16, 2.2, 2.13, 2.12, 2.13, 2.1, 2.12, 2.11, 
                            2.09, 2.09, 2.08, 2.09, 2.04, 2.04, 2.1, 2.01, 2.05, 2.03, 2.06, 1.98, 
                            1.95, 1.94, 1.91, 1.7, 1.76, 1.77, 1.83, 2.04, 1.91, 1.99, 1.99, 2.07, 
                            2.02, 2.04, 2.1, 2.06, 2.18, 2.21, 2.24, 2.23, 2.23, 1.98, 2.2, 2.18, 
                            2.18, 2.21, 2.23, 2.24, 2.24, 2.25, 1.8, 2.24, 1.73, 1.73, 2.27, 1.67, 
                            2.21, 1.72, 2.23, 2.23, 2.23, 2.24, 2.23, 2.12, 2.17, 1.74, 2.02, 1.88, 
                            1.67, 1.73, 1.83, 1.82, 1.73, 1.83, 2.19, 1.84, 1.89, 1.6, 1.71, 1.86, 
                            1.85, 1.84, 1.87, 1.91, 1.52, 1.95, 1.87, 1.89, 1.91, 1.91, 1.93, 1.9, 
                            1.91, 1.9, 1.89, 1.89, 1.91, 1.9, 1.91, 1.91, 1.91, 1.93, 1.94, 1.91, 
                            1.92, 1.77, 1.91, 1.95, 1.19, 1.96, 1.98, 1.94, 1.55, 1.91, 1.92, 1.92, 
                            1.97, 1.93, 1.99, 1.86, 1.12, 1.93, 1.92, 1.95, 1.85, 1.84, 1.91, 1.12, 
                            1.82, 1.82, 1.95, 1.24, 1.94, 1.96, 1.21, 1.83, 1.96, 1.36, 1.96, 1.82, 
                            1.92, 1.68, 1.93, 1.23, 1.96, 1.93, 1.86, 1.41, 1.16, 1.6, 1.25, 1.2, 
                            1.65, 1.66, 1.87, 1.94, 1.96, 1.91, 1.25, 1.93, 1.91, 1.7, 0.99, 1.81, 
                            1.92, 1.95, 1.5, 1.47, 1.15, 1.58, 1.18, 1.82, 1.13, 1.83, 1.91, 1.26, 
                            1.27, 1.91, 1.45, 1.6, 1.29, 1.94, 1.94, 1.23, 1.95, 1.21, 1.94, 1.86, 
                            1.9, 1.33, 1.75, 2.02, 1.98, 2.03, 1.83, 1.5, 2.04, 2.02, 1.9, 2, 2.02, 
                            1.95, 1.93, 1.95, 1.95, 1.99, 2, 1.94, 1.96, 1.86, 1.92, 1.88, 1.86, 
                            1.84, 1.87, 1.77, 1.89, 1.89, 1.88, 1.94, 1.82, 1.79, 1.86, 2.06, 2.33, 
                            1.88, 1.86, 1.81, 1.8, 1.8, 1.86, 1.9, 2, 2.06, 2.1, 2.2, 2, 2.16, 
                            1.98, 1.8, 1.8, 1.85, 1.75, 2.04, 2.19, 2.14, 2.19, 1.86, 2.1, 2.11, 
                            2.18, 2.03, 2.28, 2.19, 2.26, 2.26, 2.21, 2.21, 2.26, 2.33, 2.27, 2.21, 
                            2.12, 2.23, 2.26, 2.25, 1.88, 2.26, 2.24, 2.36, 2.29, 2.35, 2.3, 2.27, 
                            2.08, 2.05, 2.27, 2.28, 2.27, 2.28, 1.97, 2.25, 2.25, 2.25, 2.31, 2.28, 
                            2.27, 2.13, 2.24, 2.28, 2.28, 2.41, 2.34, 9.32, 2.28, 2.38, 2.27, 2.27, 
                            2.39, 2.11, 2.09, 2.1, 2.06, 2.12, 2.08, 2, 1.93, 2.02, 2.55, 1.54, 
                            1.64, 1.51, 1.55, 2.82, 2.92, 2.55, 2.37, 1.85, 1.6, 1.72, 1.74, 1.79, 
                            1.9, 1.94, 2, 2.04, 2.08, 2.12, 2.13, 2.16, 2.18, 2.18, 2.2, 2.2, 2.41, 
                            2.39, 2.38, 2.4, 2.42, 2.41, 2.43, 2.45, 2.43, 2.45, 2.43, 2.4, 2.44, 
                            2.4, 2.42, 2.43, 2.45, 2.45, 2.45, 2.46, 2.45, 2.45, 2.43, 2.51, 2.48, 
                            2.48, 2.53, 2.46, 2.49, 2.5, 2.5, 2.5, 2.52, 2.52, 2.54, 2.5, 2.48, 
                            2.5, 2.55, 2.5, 2.48, 2.5, 2.5, 2.52, 2.52, 2.48, 2.5, 2.5, 2.52, 2.46, 
                            2.53, 9 ]

obs post filters:
# Step 1: Remove Observations from the Edge of the Scan
- filter: Domain Check
  filter variables:
  - name: brightnessTemperature
    channels: *iasi_metop-a_channels
  where:
  - variable:
      name: MetaData/sensorScanPosition
    is_in: 5-56
  action:
    name: reject
#  actions:
#    - name: set
#      flag: ScanEdgeRemoval
#    - name: reject

# Step 2: Data Thinning
- filter: Gaussian Thinning
  filter variables:
  - name: brightnessTemperature
    channels: *iasi_metop-a_channels
  horizontal_mesh: 145
  use_reduced_horizontal_grid: true
  distance_norm: geodesic
  priority_variable: MetaData/fractionOfClearPixelsInFOV 
#  round_horizontal_bin_count_to_nearest: true
#  partition_longitude_bins_using_mesh: true
  action:
    name: reject
#  actions:
#    - name: set
#      flag: Thinning
#    - name: reject

# Step 3: Wavenumber Check
- filter: Perform Action 
  filter variables:
  - name: brightnessTemperature
    channels: 7024, 7027, 7029, 7032, 7038, 7043, 7046, 7049, 7069, 7072,
              7076, 7081, 7084, 7089, 7099, 7209, 7222, 7231, 7235, 7247,
              7267, 7269, 7284, 7389, 7419, 7423, 7424, 7426, 7428, 7431,
              7436, 7444, 7475, 7549, 7584, 7665, 7666, 7831, 7836, 7853,
              7865, 7885, 7888, 7912, 7950, 7972, 7980, 7995, 8007, 8015,
              8055, 8078
  where:
  - variable:
      name: MetaData/solarZenithAngle
    maxvalue: 88.9999
  - variable:
      name: water_area_fraction@GeoVaLs
    minvalue: 1.0e-12
  action:
    name: reject
#  actions:
#    - name: set
#      flag: ShortwaveIRCheck
#    - name: reject

# Step 4: Observation Error Inflation based on Wavenumber
- filter: Perform Action
  filter variables:
  - name: brightnessTemperature
    channels: *iasi_metop-a_channels
  action:
    name: inflate error
    inflation variable:
      name: ObsErrorFactorWavenumIR@ObsFunction
      channels: *iasi_metop-a_channels
      options:
        channels: *iasi_metop-a_channels

# Step 5: Observation Range Sanity Check
- filter: Bounds Check
  filter variables:
  - name: brightnessTemperature
    channels: *iasi_metop-a_channels
  minvalue: 50.00001
  maxvalue: 449.99999
#  maxvalue: 100.00000
  action:
    name: reject
#  actions:
#    - name: set
#      flag: ObsValueRangeCheck
#    - name: reject

# Step 6: Topography Check
- filter: Perform Action 
  filter variables:
  - name: brightnessTemperature
    channels: *iasi_metop-a_channels
  action:
    name: inflate error
    inflation variable:
      name: ObsFunction/ObsErrorFactorTopoRad
      channels: *iasi_metop-a_channels
      options:
        channels: *iasi_metop-a_channels
        sensor: iasi_metop-a

# Step 7: Transmittance Top Check
- filter: Perform Action 
  filter variables:
  - name: brightnessTemperature
    channels: *iasi_metop-a_channels
  action:
    name: inflate error
    inflation variable:
      name: ObsFunction/ObsErrorFactorTransmitTopRad
      channels: *iasi_metop-a_channels
      options:
        channels: *iasi_metop-a_channels

# Step 8: Cloud Detection Check
- filter: Bounds Check
  filter variables:
  - name: brightnessTemperature
    channels: *iasi_metop-a_channels
  test variables:
  - name: ObsFunction/CloudDetectMinResidualIR
    channels: *iasi_metop-a_channels
    options:
      channels: *iasi_metop-a_channels
      use_flag: [ 1, -1, -1, -1,  1, -1, -1, -1,  1, -1,
                  1, -1,  1, -1,  1,  1,  1, -1,  1,  1,
                 -1,  1,  1,  1, -1, -1,  1,  1, -1,  1,
                 -1,  1, -1,  1, -1, -1, -1, -1, -1, -1,
                 -1, -1,  1,  1,  1, -1,  1,  1,  1,  1,
                  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
                  1, -1,  1,  1,  1,  1, -1,  1,  1,  1,
                  1,  1,  1, -1,  1,  1,  1, -1,  1, -1,
                  1, -1, -1, -1,  1,  1,  1,  1, -1,  1,
                  1, -1,  1,  1,  1, -1,  1, -1,  1, -1,
                  1,  1, -1,  1,  1,  1,  1,  1,  1, -1,
                  1,  1,  1,  1, -1,  1, -1,  1, -1,  1,
                  1,  1, -1,  1,  1, -1, -1, -1,  1, -1,
                  1,  1, -1,  1,  1,  1,  1,  1,  1,  1,
                 -1,  1,  1, -1,  1,  1,  1,  1,  1,  1,
                  1,  1,  1,  1,  1, -1,  1, -1,  1, -1,
                  1,  1, -1, -1,  1,  1,  1, -1,  1,  1,
                 -1,  1, -1,  1, -1, -1, -1, -1, -1,  1,
                  1,  1,  1,  1,  1,  1, -1, -1, -1, -1,
                  1,  1,  1, -1, -1,  1, -1,  1,  1,  1,
                  1,  1, -1, -1,  1,  1, -1,  1,  1, -1,
                  1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1,  1,
                 -1, -1, -1, -1, -1, -1,  1, -1,  1, -1,
                  1, -1, -1, -1,  1, -1, -1, -1, -1, -1,
                 -1, -1,  1,  1, -1,  1,  1, -1,  1,  1,
                  1,  1,  1, -1, -1,  1, -1, -1, -1, -1,
                 -1,  1, -1,  1, -1,  1, -1, -1, -1,  1,
                  1,  1,  1,  1,  1,  1, -1,  1, -1, -1,
                 -1, -1, -1, -1, -1,  1, -1, -1,  1, -1,
                 -1, -1, -1,  1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1,  1, -1, -1, -1, -1, -1, -1,
                  1,  1, -1, -1, -1, -1, -1, -1, -1,  1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1,  1,
                 -1,  1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1,  1, -1,
                 -1,  1, -1, -1, -1, -1, -1, -1,  1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1]
      use_flag_clddet: [ 1, -1, -1, -1,  1, -1, -1, -1,  1, -1,
                         1, -1,  1, -1,  1,  1,  1, -1,  1,  1,
                        -1,  1,  1,  1, -1, -1,  1,  1, -1,  1,
                        -1,  1, -1,  1, -1, -1, -1, -1, -1, -1,
                        -1, -1,  1,  1,  1, -1,  1,  1,  1,  1,
                         1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
                         1, -1,  1,  1,  1,  1, -1,  1,  1,  1,
                         1,  1,  1, -1,  1,  1,  1, -1,  1, -1,
                         1, -1, -1, -1,  1,  1,  1,  1, -1,  1,
                         1, -1,  1,  1,  1, -1,  1, -1,  1, -1,
                         1,  1, -1,  1,  1,  1,  1,  1,  1, -1,
                         1,  1,  1,  1, -1,  1, -1,  1, -1,  1,
                         1,  1, -1,  1,  1, -1, -1, -1,  1, -1,
                         1,  1, -1,  1,  1,  1,  1,  1,  1,  1,
                        -1,  1,  1, -1,  1,  1,  1,  1,  1,  1,
                         1,  1,  1,  1,  1, -1,  1, -1,  1, -1,
                         1,  1, -1, -1,  1,  1,  1, -1,  1,  1,
                        -1,  1, -1,  1, -1, -1, -1, -1, -1,  1,
                         1,  1,  1,  1,  1,  1, -1, -1, -1, -1,
                         1,  1,  1, -1, -1,  1, -1,  1,  1,  1,
                         1,  1, -1, -1,  1,  1, -1,  1,  1, -1,
                         1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1,  1, -1,  1, -1,  1, -1, -1, -1,  1,
                         1,  1,  1,  1,  1,  1, -1,  1, -1, -1,
                        -1, -1, -1, -1, -1,  1, -1, -1,  1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                        -1, -1, -1, -1, -1, -1]
      obserr_dtempf: [0.50,2.00,4.00,2.00,4.00]
      error parameter vector: *iasi_metop-a_oberr
  maxvalue: 1.0e-12
  action:
    name: reject
#  actions:
#    - name: set
#      flag: CloudDetection
#    - name: reject

# Step 9: NSST Retrieval Check
- filter: Bounds Check
  filter variables:
  - name: brightnessTemperature
    channels: *iasi_metop-a_channels
  test variables:
  - name: NearSSTRetCheckIR@ObsFunction
    channels: *iasi_metop-a_channels
    options:
      channels: *iasi_metop-a_channels
      use_flag: [ 1, -1, -1, -1,  1, -1, -1, -1,  1, -1,
                  1, -1,  1, -1,  1,  1,  1, -1,  1,  1,
                 -1,  1,  1,  1, -1, -1,  1,  1, -1,  1,
                 -1,  1, -1,  1, -1, -1, -1, -1, -1, -1,
                 -1, -1,  1,  1,  1, -1,  1,  1,  1,  1,
                  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
                  1, -1,  1,  1,  1,  1, -1,  1,  1,  1,
                  1,  1,  1, -1,  1,  1,  1, -1,  1, -1,
                  1, -1, -1, -1,  1,  1,  1,  1, -1,  1,
                  1, -1,  1,  1,  1, -1,  1, -1,  1, -1,
                  1,  1, -1,  1,  1,  1,  1,  1,  1, -1,
                  1,  1,  1,  1, -1,  1, -1,  1, -1,  1,
                  1,  1, -1,  1,  1, -1, -1, -1,  1, -1,
                  1,  1, -1,  1,  1,  1,  1,  1,  1,  1,
                 -1,  1,  1, -1,  1,  1,  1,  1,  1,  1,
                  1,  1,  1,  1,  1, -1,  1, -1,  1, -1,
                  1,  1, -1, -1,  1,  1,  1, -1,  1,  1,
                 -1,  1, -1,  1, -1, -1, -1, -1, -1,  1,
                  1,  1,  1,  1,  1,  1, -1, -1, -1, -1,
                  1,  1,  1, -1, -1,  1, -1,  1,  1,  1,
                  1,  1, -1, -1,  1,  1, -1,  1,  1, -1,
                  1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1,  1,
                 -1, -1, -1, -1, -1, -1,  1, -1,  1, -1,
                  1, -1, -1, -1,  1, -1, -1, -1, -1, -1,
                 -1, -1,  1,  1, -1,  1,  1, -1,  1,  1,
                  1,  1,  1, -1, -1,  1, -1, -1, -1, -1,
                 -1,  1, -1,  1, -1,  1, -1, -1, -1,  1,
                  1,  1,  1,  1,  1,  1, -1,  1, -1, -1,
                 -1, -1, -1, -1, -1,  1, -1, -1,  1, -1,
                 -1, -1, -1,  1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1,  1, -1, -1, -1, -1, -1, -1,
                  1,  1, -1, -1, -1, -1, -1, -1, -1,  1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1,  1,
                 -1,  1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1,  1, -1,
                 -1,  1, -1, -1, -1, -1, -1, -1,  1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1]
      obserr_demisf: [0.01,0.02,0.03,0.02,0.03]
      obserr_dtempf: [0.50,2.00,4.00,2.00,4.00]
  maxvalue: 1.0e-12
  action:
    name: reject
#  actions:
#    - name: set
#      flag: NSSTCheck
#    - name: reject

# Step 10: Surface Jacobians Check
- filter: Perform Action 
  filter variables:
  - name: brightnessTemperature
    channels: *iasi_metop-a_channels
  action:
    name: inflate error
    inflation variable:
      name: ObsFunction/ObsErrorFactorSurfJacobianRad
      channels: *iasi_metop-a_channels
      options:
        channels: *iasi_metop-a_channels
        obserr_demisf: [0.01, 0.02, 0.03, 0.02, 0.03]
        obserr_dtempf: [0.50, 2.00, 4.00, 2.00, 4.00]
        sensor: iasi_metop-a

# Step 11: Gross check
- filter: Background Check
  filter variables:
  - name: brightnessTemperature
    channels: *iasi_metop-a_channels
  function absolute threshold:
  - name: ObsFunction/ObsErrorBoundIR
    channels: *iasi_metop-a_channels
    options:
      channels: *iasi_metop-a_channels
      obserr_bound_latitude:
        name: ObsFunction/ObsErrorFactorLatRad
        options:
          latitude_parameters: [25.0, 0.5, 0.04, 1.0]
      obserr_bound_transmittop:
        name: ObsFunction/ObsErrorFactorTransmitTopRad
        channels: *iasi_metop-a_channels
        options:
          channels: *iasi_metop-a_channels
      obserr_bound_max: [ 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0,
                          2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0,
                          2.0, 2.0, 4.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0,
                          2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0,
                          3.5, 2.5, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0,
                          2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0,
                          2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0,
                          2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0,
                          3.5, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 2.0, 2.0,
                          2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0,
                          2.0, 2.0, 2.0, 2.0, 2.5, 2.0, 2.5, 2.5, 3.0, 2.5,
                          2.5, 2.5, 2.5, 3.5, 2.5, 2.5, 3.0, 3.5, 3.0, 4.0,
                          4.0, 4.0, 4.0, 4.0, 4.0, 4.5, 4.5, 4.5, 4.5, 4.5,
                          4.0, 4.5, 4.0, 4.0, 4.5, 2.5, 3.0, 2.5, 3.0, 2.5,
                          3.0, 2.0, 2.5, 2.5, 3.0, 3.0, 2.5, 3.0, 3.0, 3.0,
                          2.5, 2.5, 4.0, 4.5, 4.5, 5.0, 4.0, 4.0, 5.0, 5.0,
                          5.0, 5.0, 5.5, 5.5, 4.0, 5.0, 4.0, 4.5, 5.5, 5.5,
                          6.0, 4.5, 4.5, 4.0, 5.0, 5.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 5.5, 4.5, 6.0,
                          5.0, 5.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 5.0, 6.0,
                          6.0, 6.0, 4.0, 6.0, 6.0, 6.0, 6.0, 4.5, 6.0, 6.0,
                          4.5, 6.0, 6.0, 6.0, 6.0, 6.0, 5.0, 6.0, 6.0, 6.0,
                          5.0, 6.0, 6.0, 5.0, 6.0, 5.0, 6.0, 6.0, 6.0, 5.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
                          6.0, 6.0, 6.0, 6.0, 6.0, 6.0]
      error parameter vector: *iasi_metop-a_oberr
  action:
    name: reject
#  actions:
#    - name: set
#      flag: GrossCheck
#    - name: reject

# Step 12: Useflag Check
- filter: Bounds Check
  filter variables:
  - name: brightnessTemperature
    channels: *iasi_metop-a_channels
  test variables:
  - name: ObsFunction/ChannelUseflagCheckRad
    channels: *iasi_metop-a_channels
    options:
      channels: *iasi_metop-a_channels
      use_flag: [ 1, -1, -1, -1,  1, -1, -1, -1,  1, -1,
                  1, -1,  1, -1,  1,  1,  1, -1,  1,  1,
                 -1,  1,  1,  1, -1, -1,  1,  1, -1,  1,
                 -1,  1, -1,  1, -1, -1, -1, -1, -1, -1,
                 -1, -1,  1,  1,  1, -1,  1,  1,  1,  1,
                  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
                  1, -1,  1,  1,  1,  1, -1,  1,  1,  1,
                  1,  1,  1, -1,  1,  1,  1, -1,  1, -1,
                  1, -1, -1, -1,  1,  1,  1,  1, -1,  1,
                  1, -1,  1,  1,  1, -1,  1, -1,  1, -1,
                  1,  1, -1,  1,  1,  1,  1,  1,  1, -1,
                  1,  1,  1,  1, -1,  1, -1,  1, -1,  1,
                  1,  1, -1,  1,  1, -1, -1, -1,  1, -1,
                  1,  1, -1,  1,  1,  1,  1,  1,  1,  1,
                 -1,  1,  1, -1,  1,  1,  1,  1,  1,  1,
                  1,  1,  1,  1,  1, -1,  1, -1,  1, -1,
                  1,  1, -1, -1,  1,  1,  1, -1,  1,  1,
                 -1,  1, -1,  1, -1, -1, -1, -1, -1,  1,
                  1,  1,  1,  1,  1,  1, -1, -1, -1, -1,
                  1,  1,  1, -1, -1,  1, -1,  1,  1,  1,
                  1,  1, -1, -1,  1,  1, -1,  1,  1, -1,
                  1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1,  1,
                 -1, -1, -1, -1, -1, -1,  1, -1,  1, -1,
                  1, -1, -1, -1,  1, -1, -1, -1, -1, -1,
                 -1, -1,  1,  1, -1,  1,  1, -1,  1,  1,
                  1,  1,  1, -1, -1,  1, -1, -1, -1, -1,
                 -1,  1, -1,  1, -1,  1, -1, -1, -1,  1,
                  1,  1,  1,  1,  1,  1, -1,  1, -1, -1,
                 -1, -1, -1, -1, -1,  1, -1, -1,  1, -1,
                 -1, -1, -1,  1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1,  1, -1, -1, -1, -1, -1, -1,
                  1,  1, -1, -1, -1, -1, -1, -1, -1,  1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1,  1,
                 -1,  1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1,  1, -1,
                 -1,  1, -1, -1, -1, -1, -1, -1,  1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                 -1, -1, -1, -1, -1, -1]
  minvalue: 1.0e-12
  action:
    name: reject
#  actions:
#    - name: set
#      flag: UseFlagCheck 
#    - name: reject
